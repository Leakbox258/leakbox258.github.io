---
layout: post
title: "dlé¢˜å†…å­˜å¸ƒå±€åˆæ¢"
date:   2024-10-8
tags: [CTF]
comments: true
author: ä¹…èœåˆå­
---


### å‰æƒ…æè¦

##### &emsp;&emsp;&emsp;ä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨é€‰æ‹©dlæ”»å‡»æ—¶ï¼Œå¾€å¾€æ²¡æœ‰å›æ˜¾ï¼Œä¹Ÿå°±æ˜¯æ— æ³•å¾—åˆ°attachmentã€libcã€ldçš„åœ¨å†…å­˜ä¸­çš„åŠ è½½åŸºå€ï¼Œ<br>&emsp;&emsp;&emsp;ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸‰è€…çš„åŠ è½½åœ°å€åº”è¯¥æ˜¯äº’ä¸ç›¸å…³çš„ï¼Œä½†æ ¹æ®ä¸ªäººç»éªŒæ¥çœ‹ï¼Œlibcå’Œldä¸€èˆ¬æ˜¯è¿åœ¨ä¸€èµ·çš„ï¼ˆä¸­é—´å¯èƒ½æœ‰åˆ«çš„å†…å­˜é¡µï¼‰ï¼Œä¹Ÿå°±æ˜¯çŸ¥é“å…¶ä¸­ä¸€ä¸ªçš„åŸºå€ä»¥åŠå†…å­˜çš„å¸ƒå±€ï¼Œå°±å¯ä»¥çŸ¥é“å¦ä¸€ä¸ªçš„åŸºå€<br>
#####  &emsp;&emsp;&emsp;é‚£ä¹ˆ```__dl_runtime_resolve```æ—¶å¦‚ä½•æ‰¾åˆ°ï¼Œè¿™ä¸‰è€…çš„å…³ç³»ï¼Œä¾é çš„æ˜¯åœ¨ldä¸­çš„linkmapè¡¨ï¼Œè¿™ä¸ªè¡¨è®°å½•ä¸‰ä¸ªæ–‡ä»¶ï¼ˆæˆ–è®¸æ›´å¤šï¼‰çš„linkmapåœ°å€ï¼Œè€Œlinkmapä¸­å°±å«æœ‰åŠ è½½åŸºå€çš„ä¿¡æ¯ã€‚
#####  &emsp;&emsp;&emsp;ä»¥ä¸‹çš„æ‰€æœ‰è°ƒè¯•å’Œmapsçš„æŸ¥çœ‹å‡ä»¥ä¹‹å‰çš„bossé¢˜ä¸ºä¾‹ï¼Œä½†å®é™…ä¸Šé‡ç‚¹åœ¨äºè¯¥ç¨‹åº```mmap()```ä¸€ä¸ª0x2000å¤§å°å¯è¯»å†™çš„å†…å­˜æ®µï¼Œæœ¬æ–‡çš„ä¸€ä¸ªé‡å¿ƒå°†ä¼šæ˜¯è¿™ä¸ª```mmap()```å¾—åˆ°çš„å†…å­˜çš„ç›¸å¯¹ä½ç½®ã€‚

```c
pwndbg> linkmap
Node           Objfile                                                            Load Bias      Dynamic Segment 
0x7ffff7ffe2e0 <Unknown, likely /home/pwn/worktable/cnss2024/boss/src/attachment> 0x555555554000 0x555555557df8  
0x7ffff7ffe890 linux-vdso.so.1                                                    0x7ffff7fc1000 0x7ffff7fc13a0  
0x7ffff7fbb160 /lib/x86_64-linux-gnu/libc.so.6                                    0x7ffff7d83000 0x7ffff7f9cbc0  
0x7ffff7ffdaf0 /lib64/ld-linux-x86-64.so.2                                        0x7ffff7fc3000 0x7ffff7ffce80  
```
##### &emsp;&emsp;&emsp;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œlinkmapçš„ä½ç½®åœ¨ld.soä¸­çš„ä¸€æ®µå¯è¯»å†™çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯è¯´ç®—å¥½åç§»å°±å¯ä»¥ç¯¡æ”¹linkmapã€‚

### è°ƒè¯•æ–¹æ³•ä¸åŒæ—¶å†…å­˜å¸ƒå±€çš„ä¸åŒ
##### &emsp;&emsp;&emsp;é¦–å…ˆæ¢ç´¢çš„æ˜¯è°ƒè¯•æ–¹æ³•ä¸åŒæ—¶ï¼Œå†…å­˜å¸ƒå±€çš„ä¸åŒ<br>&emsp;&emsp;&emsp;ä¸€èˆ¬ä½¿ç”¨```gdb```æœ‰ä¸¤ç§æ–¹æ³•ï¼Œ```gdb attachment```ä»¥åŠ```gdb --pid=xxxx```ï¼Œä¹Ÿå°±æ˜¯```gdb```ç›´æ¥è°ƒè¯•æ–‡ä»¶æˆ–è€…é“¾æ¥è¿›ç¨‹è¿›è¡Œè°ƒè¯•ï¼Œå®é™…ä¸Šè¿™ä¸¤è€…å°±ç®—ä»…ä»…æ˜¯ä»æ•ˆæœä¸Šçœ‹å°±æœ‰å¾ˆå¤§ä¸åŒã€‚<br>
##### &emsp;&emsp;&emsp;é¦–å…ˆçœ‹```gdb --pid=xxx```çš„vmmapï¼Œè¿™ä¸ªç»“æœæ›´åŠ æ¥è¿‘ä¸€ä¸ªè¿›ç¨‹çš„çœŸå®vmmapï¼Œä¹Ÿå°±æ˜¯å’Œ```cat /proc/xxx/maps```çš„ç»“æœç›¸è¿‘
```rust
pwndbg> vmmap
LEGEND: STACK | HEAP | CODE | DATA | WX | RODATA
             Start                End Perm     Size Offset File
    0x5631723b9000     0x5631723ba000 r--p     1000      0 /home/pwn/worktable/cnss2024/boss/src/attachment
    0x5631723ba000     0x5631723bb000 r-xp     1000   1000 /home/pwn/worktable/cnss2024/boss/src/attachment
    0x5631723bb000     0x5631723bc000 r--p     1000   2000 /home/pwn/worktable/cnss2024/boss/src/attachment
    0x5631723bc000     0x5631723bd000 r--p     1000   2000 /home/pwn/worktable/cnss2024/boss/src/attachment
    0x5631723bd000     0x5631723be000 rw-p     1000   3000 /home/pwn/worktable/cnss2024/boss/src/attachment
    0x7f99a605f000     0x7f99a6062000 rw-p     3000      0 [anon_7f99a605f]
    0x7f99a6062000     0x7f99a608a000 r--p    28000      0 /usr/lib/x86_64-linux-gnu/libc.so.6
    0x7f99a608a000     0x7f99a621f000 r-xp   195000  28000 /usr/lib/x86_64-linux-gnu/libc.so.6
    0x7f99a621f000     0x7f99a6277000 r--p    58000 1bd000 /usr/lib/x86_64-linux-gnu/libc.so.6
    0x7f99a6277000     0x7f99a6278000 ---p     1000 215000 /usr/lib/x86_64-linux-gnu/libc.so.6
    0x7f99a6278000     0x7f99a627c000 r--p     4000 215000 /usr/lib/x86_64-linux-gnu/libc.so.6
    0x7f99a627c000     0x7f99a627e000 rw-p     2000 219000 /usr/lib/x86_64-linux-gnu/libc.so.6
    0x7f99a627e000     0x7f99a628b000 rw-p     d000      0 [anon_7f99a627e]
    0x7f99a6298000     0x7f99a629c000 rw-p     4000      0 [anon_7f99a6298] # <---mmapå¾—åˆ°çš„ç©ºé—´
    0x7f99a629c000     0x7f99a629e000 r--p     2000      0 /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
    0x7f99a629e000     0x7f99a62c8000 r-xp    2a000   2000 /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
    0x7f99a62c8000     0x7f99a62d3000 r--p     b000  2c000 /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
    0x7f99a62d4000     0x7f99a62d6000 r--p     2000  37000 /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
    0x7f99a62d6000     0x7f99a62d8000 rw-p     2000  39000 /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
    0x7ffd84bf2000     0x7ffd84c14000 rw-p    22000      0 [stack]
    0x7ffd84c46000     0x7ffd84c4a000 r--p     4000      0 [vvar]
    0x7ffd84c4a000     0x7ffd84c4c000 r-xp     2000      0 [vdso]
```
##### &emsp;&emsp;&emsp;ç„¶åæ˜¯ä½¿ç”¨```gdb attachment```çš„æ•ˆæœï¼Œå¯ä»¥çœ‹åˆ°çš„æ˜¯mmapå¾—åˆ°çš„ç©ºé—´å’Œld.soä¹‹é—´å¤šäº†0x6000çš„```[vvar]å’Œ[vsdo]```ï¼Œè¿™ä¸¤ä¸ªæœ¬æ¥æ˜¯åœ¨æ ˆæ®µä¸‹æ–¹çš„ã€‚<br>&emsp;&emsp;&emsp;å…¶æ¬¡ï¼Œå¦‚æœå¤šæ¬¡è°ƒè¯•å‘ç°ï¼Œattachmentã€libcã€ldçš„åŠ è½½åœ°å€å®é™…ä¸Šæ˜¯å›ºå®šçš„ï¼Œä¹Ÿå°±æ˜¯0x555555554000ã€0x7ffff7d83000ã€0x7ffff7fc3000å®é™…ä¸Šæ²¡å˜ï¼Œåº”è¯¥æ˜¯å‡ºäºæ–¹ä¾¿è°ƒè¯•æ‰€ä»¥å›ºå®šäº†åŠ è½½åœ°å€ã€‚
```rust
pwndbg> vmmap
LEGEND: STACK | HEAP | CODE | DATA | WX | RODATA
             Start                End Perm     Size Offset File
    0x555555554000     0x555555555000 r--p     1000      0 /home/pwn/worktable/cnss2024/boss/src/attachment
    0x555555555000     0x555555556000 r-xp     1000   1000 /home/pwn/worktable/cnss2024/boss/src/attachment
    0x555555556000     0x555555557000 r--p     1000   2000 /home/pwn/worktable/cnss2024/boss/src/attachment
    0x555555557000     0x555555558000 r--p     1000   2000 /home/pwn/worktable/cnss2024/boss/src/attachment
    0x555555558000     0x555555559000 rw-p     1000   3000 /home/pwn/worktable/cnss2024/boss/src/attachment
    0x7ffff7d80000     0x7ffff7d83000 rw-p     3000      0 [anon_7ffff7d80]
    0x7ffff7d83000     0x7ffff7dab000 r--p    28000      0 /usr/lib/x86_64-linux-gnu/libc.so.6
    0x7ffff7dab000     0x7ffff7f40000 r-xp   195000  28000 /usr/lib/x86_64-linux-gnu/libc.so.6
    0x7ffff7f40000     0x7ffff7f98000 r--p    58000 1bd000 /usr/lib/x86_64-linux-gnu/libc.so.6
    0x7ffff7f98000     0x7ffff7f99000 ---p     1000 215000 /usr/lib/x86_64-linux-gnu/libc.so.6
    0x7ffff7f99000     0x7ffff7f9d000 r--p     4000 215000 /usr/lib/x86_64-linux-gnu/libc.so.6
    0x7ffff7f9d000     0x7ffff7f9f000 rw-p     2000 219000 /usr/lib/x86_64-linux-gnu/libc.so.6
    0x7ffff7f9f000     0x7ffff7fac000 rw-p     d000      0 [anon_7ffff7f9f]
    0x7ffff7fb9000     0x7ffff7fbd000 rw-p     4000      0 [anon_7ffff7fb9] # <-- mmapå¾—åˆ°çš„åœ°æ–¹
    0x7ffff7fbd000     0x7ffff7fc1000 r--p     4000      0 [vvar]
    0x7ffff7fc1000     0x7ffff7fc3000 r-xp     2000      0 [vdso]
    0x7ffff7fc3000     0x7ffff7fc5000 r--p     2000      0 /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
    0x7ffff7fc5000     0x7ffff7fef000 r-xp    2a000   2000 /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
    0x7ffff7fef000     0x7ffff7ffa000 r--p     b000  2c000 /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
    0x7ffff7ffb000     0x7ffff7ffd000 r--p     2000  37000 /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
    0x7ffff7ffd000     0x7ffff7fff000 rw-p     2000  39000 /usr/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
    0x7ffffffdd000     0x7ffffffff000 rw-p    22000      0 [stack]
```

### ä½¿ç”¨patchelfåçš„å†…å­˜å¸ƒå±€
#####  &emsp;&emsp;&emsp;ä¸€èˆ¬pwné¢˜æ—¶ï¼Œå°¤å…¶Cçš„pwné¢˜æ—¶ï¼Œä¼šé€‰æ‹©ä½¿ç”¨```patchelf```ï¼Œæ›´æ”¹libcå’Œldä¸ºæŒ‡å®šglibcç‰ˆæœ¬çš„æ¥è·å¾—å’Œè¿œç¨‹ç›¸è¿‘çš„æœ¬åœ°ç¯å¢ƒï¼Œä½†æ˜¯```patchelf```ä¹Ÿä¼šä½¿è¿›ç¨‹çš„å†…å­˜å¸ƒå±€å‘ç”Ÿå˜åŒ–ã€‚<br>
#####  &emsp;&emsp;&emsp;é¦–å…ˆè·å¾—ä¸€ä¸ª```patchelf```åçš„æ–‡ä»¶
```sh
$ ldd attachment # patchelfä¹‹å‰
        linux-vdso.so.1 (0x00007ffd469a6000)
        libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f8a8e7db000)
        /lib64/ld-linux-x86-64.so.2 (0x00007f8a8ea1a000)
$ patchelf --replace-needed libc.so.6 /home/pwn/glibc-all-in-one/libs/2.35-0ubuntu3_amd64/libc.so.6 attachment
$ patchelf --set-interpreter /home/pwn/glibc-all-in-one/libs/2.35-0ubuntu3_amd64/ld-linux-x86-64.so.2 attachment
$ ldd attachment
        linux-vdso.so.1 (0x00007ffd73beb000)
        /home/pwn/glibc-all-in-one/libs/2.35-0ubuntu3_amd64/libc.so.6 (0x00007f9a1054c000)
        /home/pwn/glibc-all-in-one/libs/2.35-0ubuntu3_amd64/ld-linux-x86-64.so.2 => /lib64/ld-linux-x86-64.so.2 (0x00007f9a1077d000)
``` 
#####  &emsp;&emsp;&emsp;ç„¶å```gdb --pi=xxx```å°è¯•è°ƒè¯•ã€‚
```rust
pwndbg> vmmap
LEGEND: STACK | HEAP | CODE | DATA | WX | RODATA
             Start                End Perm     Size Offset File
    0x56272a397000     0x56272a398000 r--p     1000      0 /home/pwn/testtable/attachment
    0x56272a398000     0x56272a399000 r-xp     1000   1000 /home/pwn/testtable/attachment
    0x56272a399000     0x56272a39a000 r--p     1000   2000 /home/pwn/testtable/attachment
    0x56272a39a000     0x56272a39b000 r--p     1000   2000 /home/pwn/testtable/attachment
    0x56272a39b000     0x56272a39e000 rw-p     3000   3000 /home/pwn/testtable/attachment
    0x7fc2b8155000     0x7fc2b815a000 rw-p     5000      0 [anon_7fc2b8155] # <-----mmapçš„ä½ç½®
    0x7fc2b815a000     0x7fc2b8182000 r--p    28000      0 /home/pwn/glibc-all-in-one/libs/2.35-0ubuntu3_amd64/libc.so.6
    0x7fc2b8182000     0x7fc2b8317000 r-xp   195000  28000 /home/pwn/glibc-all-in-one/libs/2.35-0ubuntu3_amd64/libc.so.6
    0x7fc2b8317000     0x7fc2b836f000 r--p    58000 1bd000 /home/pwn/glibc-all-in-one/libs/2.35-0ubuntu3_amd64/libc.so.6
    0x7fc2b836f000     0x7fc2b8373000 r--p     4000 214000 /home/pwn/glibc-all-in-one/libs/2.35-0ubuntu3_amd64/libc.so.6
    0x7fc2b8373000     0x7fc2b8375000 rw-p     2000 218000 /home/pwn/glibc-all-in-one/libs/2.35-0ubuntu3_amd64/libc.so.6
    0x7fc2b8375000     0x7fc2b8384000 rw-p     f000      0 [anon_7fc2b8375]
    0x7fc2b8384000     0x7fc2b8386000 r--p     2000      0 /home/pwn/glibc-all-in-one/libs/2.35-0ubuntu3_amd64/ld-linux-x86-64.so.2
    0x7fc2b8386000     0x7fc2b83b0000 r-xp    2a000   2000 /home/pwn/glibc-all-in-one/libs/2.35-0ubuntu3_amd64/ld-linux-x86-64.so.2
    0x7fc2b83b0000     0x7fc2b83bb000 r--p     b000  2c000 /home/pwn/glibc-all-in-one/libs/2.35-0ubuntu3_amd64/ld-linux-x86-64.so.2
    0x7fc2b83bc000     0x7fc2b83be000 r--p     2000  37000 /home/pwn/glibc-all-in-one/libs/2.35-0ubuntu3_amd64/ld-linux-x86-64.so.2
    0x7fc2b83be000     0x7fc2b83c0000 rw-p     2000  39000 /home/pwn/glibc-all-in-one/libs/2.35-0ubuntu3_amd64/ld-linux-x86-64.so.2
    0x7fff90916000     0x7fff90938000 rw-p    22000      0 [stack]
    0x7fff90968000     0x7fff9096c000 r--p     4000      0 [vvar]
    0x7fff9096c000     0x7fff9096e000 r-xp     2000      0 [vdso]
```
#####  &emsp;&emsp;&emsp;å¯ä»¥çœ‹åˆ°ï¼Œmmapè·å¾—çš„ç©ºé—´ç°åœ¨å˜æˆäº†åœ¨libcä¸Šæ–¹ï¼ŒåŸå› æš‚æ—¶æœªçŸ¥ã€‚

### xintedè½¬å‘ä¼šè¯æ—¶å¯åŠ¨çš„è¿›ç¨‹
#####  &emsp;&emsp;&emsp;ä¹‹å‰dockerå†…å¯è¡Œçš„exp,åœ¨è®¿é—®ç«¯å£(æœ¬åœ°dockeræˆ–è€…æœåŠ¡å™¨è¿œç¨‹)ä¸Šçš„é¢˜ç›®æ—¶,å‘ç°æ— æ³•æ‰“é€š,äºæ˜¯çŒœæµ‹æ˜¯xintedè½¬å‘çš„è¿›ç¨‹å†…å­˜å¸ƒå±€ä¸åŒ<br>
#####  &emsp;&emsp;&emsp;åœ¨æ­£å¼æŸ¥çœ‹ä¹‹å‰,å…ˆåšå‡†å¤‡å·¥ä½œ,ç¬¬ä¸€æ­¥å…ˆä¿®æ”¹ä»¥ä¸‹xintedçš„è®¾ç½®
```rust
service ctf
{
    disable = no
    socket_type = stream
    protocol    = tcp
    wait        = no
    user        = root
    type        = UNLISTED
    port        = 9999
    bind        = 0.0.0.0
    # è®¾ç½®xinetdè¿æ¥å¯åŠ¨åçš„æœåŠ¡ç¨‹åº
    server      = /usr/sbin/chroot
    # è®¾ç½®chrootçš„ç›¸å…³å‚æ•°
    server_args = --userspec=0000:0000 /home/ctf ./attachment # <---- è¿™é‡Œæ”¹ä¸ºä»¥rootç”¨æˆ·æ‰§è¡Œæ–‡ä»¶,å¦åˆ™ä¹‹åçœ‹mapsæ²¡æƒé™
    banner_fail = /etc/banner_fail
    # safety options
    per_source	= 10 # the maximum instances of this service per source IP address
    rlimit_cpu	= 20 # the maximum number of CPU seconds that the service may use
    #rlimit_as  = 1024M # the Address Space resource limit for the service
    #access_times = 2:00-9:00 12:00-24:00
}

```
#####  &emsp;&emsp;&emsp;ç„¶åæ„å»ºé•œåƒ
```bash
$ docker build -t boss .
$ docker run -p 8000:9999 boss
# åˆ‡æ¢ä¸€ä¸ªshell
$ docker exec -it <å®¹å™¨å> /bin/bash
<å®¹å™¨å>/home/ctf$ apt-get install gdb
```
#####  &emsp;&emsp;&emsp;å†æ‰“å¼€ä¸€ä¸ªshell,```nc localhost 8000```,ç°åœ¨dockerå®¹å™¨ä¸­å°±å­˜åœ¨ä¸€ä¸ªattachmentçš„è¿›ç¨‹,ç”±xindtedè½¬å‘<br> &emsp;&emsp;&emsp;æ­¤æ—¶å…ˆæ‰¾åˆ°pid
```rust
<å®¹å™¨å>/home/ctf$ ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root         1  0.0  0.0   4364  3164 ?        Ss   00:16   0:00 /bin/bash /docker-entrypoint.sh
root        19  0.0  0.0   2792  1036 ?        S    00:16   0:00 sleep infinity
root        20  0.0  0.0  13784  2392 ?        Ss   00:16   0:00 /usr/sbin/xinetd -pidfile /run/xinetd.pid -stayalive -inetd_c
root        21  0.0  0.0   4628  3720 pts/0    Ss   00:16   0:00 /bin/bash
root        29  0.0  0.0   2652   264 ?        Ss   00:17   0:00 ./attachment # <--- åœ¨è¿™é‡Œ
root        30  0.0  0.0   7064  1552 pts/0    R+   00:17   0:00 ps aux
```
##### &emsp;&emsp;&emsp;ç°åœ¨è°ƒè¯•è¿™ä¸ªpid
```rust
<å®¹å™¨å>/home/ctf$ gdb --pi=29
(gdb) x/10gx 0x56341ccb5000 + 0x40a0
0x56341ccb90a0: 0x00007ff9322bc000      0x0000000000000000
0x56341ccb90b0: 0x0000000000000000      0x0000000000000000
0x56341ccb90c0: 0x0000000000000000      0x0000000000000000
0x56341ccb90d0: 0x0000000000000000      0x0000000000000000
0x56341ccb90e0: 0x0000000000000000      0x0000000000000000
```

```rust
<å®¹å™¨å>/home/ctf$ cat /proc/29/maps
56341ccb5000-56341ccb6000 r--p 00000000 08:30 20412                      /home/ctf/attachment
56341ccb6000-56341ccb7000 r-xp 00001000 08:30 20412                      /home/ctf/attachment
56341ccb7000-56341ccb8000 r--p 00002000 08:30 20412                      /home/ctf/attachment
56341ccb8000-56341ccb9000 r--p 00002000 08:30 20412                      /home/ctf/attachment
56341ccb9000-56341ccba000 rw-p 00003000 08:30 20412                      /home/ctf/attachment
7ff9322bc000-7ff9322c1000 rw-p 00000000 00:00 0 # <------- è¿™é‡Œ
7ff9322c1000-7ff9322e9000 r--p 00000000 08:30 19693                      /home/ctf/lib/x86_64-linux-gnu/libc.so.6
7ff9322e9000-7ff93247e000 r-xp 00028000 08:30 19693                      /home/ctf/lib/x86_64-linux-gnu/libc.so.6
7ff93247e000-7ff9324d6000 r--p 001bd000 08:30 19693                      /home/ctf/lib/x86_64-linux-gnu/libc.so.6
7ff9324d6000-7ff9324d7000 ---p 00215000 08:30 19693                      /home/ctf/lib/x86_64-linux-gnu/libc.so.6
7ff9324d7000-7ff9324db000 r--p 00215000 08:30 19693                      /home/ctf/lib/x86_64-linux-gnu/libc.so.6
7ff9324db000-7ff9324dd000 rw-p 00219000 08:30 19693                      /home/ctf/lib/x86_64-linux-gnu/libc.so.6
7ff9324dd000-7ff9324ec000 rw-p 00000000 00:00 0 
7ff9324ec000-7ff9324ee000 r--p 00000000 08:30 19672                      /home/ctf/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
7ff9324ee000-7ff932518000 r-xp 00002000 08:30 19672                      /home/ctf/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
7ff932518000-7ff932523000 r--p 0002c000 08:30 19672                      /home/ctf/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
7ff932524000-7ff932526000 r--p 00037000 08:30 19672                      /home/ctf/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
7ff932526000-7ff932528000 rw-p 00039000 08:30 19672                      /home/ctf/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2
7ffdbc5a8000-7ffdbc5c9000 rw-p 00000000 00:00 0                          [stack]
7ffdbc5ec000-7ffdbc5f0000 r--p 00000000 00:00 0                          [vvar]
7ffdbc5f0000-7ffdbc5f2000 r-xp 00000000 00:00 0                          [vdso]
```
##### &emsp;&emsp;&emsp;ç»“æœå‘ç°è¿™ä¸ªxintedè½¬å‘çš„è¿›ç¨‹çš„å†…å­˜å¸ƒå±€å’Œpatchelfçš„ä¼¼ä¹ä¸€è‡´,mmapçš„ä½ç½®éƒ½åœ¨libcä¸Šé¢,å…¶ä»–é•¿åº¦ä¹Ÿæ˜¯å¯¹åº”çš„.<br>&emsp;&emsp;&emsp;è¿™ä¸ªç»“æœå°±æœ‰ç‚¹å­å¹½é»˜äº†,æœ¬æ¥å°±æ˜¯patchelfæ— æ³•å¾—åˆ°å®Œå…¨ä¸€è‡´çš„å†…å­˜å¸ƒå±€æ‰€ä»¥ç»™äº†Dockerfile,ç»“æœç°åœ¨xintedè½¬å‘çš„è¿›ç¨‹å†…å­˜å¸ƒå±€ä¸ä¸€æ ·,åå€’å’Œpatchelfçš„ç»“æœæ­£å¥½å¯¹ä¸Šäº†ğŸ˜…ğŸ˜…ğŸ˜…
### END